<?xml version="1.0" encoding="utf-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
  xmlns:mailappor="http://schemas.microsoft.com/office/mailappversionoverrides"
  xsi:type="MailApp">
  <Id>3213AF34-806E-2D05-BBAF-EF3384D30022</Id>
  <Version>1.1</Version>
  <ProviderName>Outlook Add-ins Team (exext)</ProviderName>
  <DefaultLocale>en-us</DefaultLocale>
  <DisplayName DefaultValue="Outlook Dogfood" />
  <Description DefaultValue="An add-in used to dogfood new features internally"/>
  <IconUrl DefaultValue="https://outlmoe/timwan/dogfoodaddin/icons/dog2.png" />
  <Hosts>
    <Host Name="Mailbox" />
  </Hosts>
  <Requirements>
    <Sets DefaultMinVersion="1.1">
      <Set MinVersion="1.1" Name="Mailbox" />
    </Sets>
  </Requirements>
  <FormSettings>
    <Form xsi:type="ItemRead">
      <DesktopSettings>
        <SourceLocation DefaultValue="https://featuretest.olkeco.com/FeatureTest/Read/readIndexDebug.htm" />
        <RequestedHeight>350</RequestedHeight>
      </DesktopSettings>
      <TabletSettings>
        <SourceLocation DefaultValue="https://featuretest.olkeco.com/FeatureTest/Read/readIndexDebug.htm" />
        <RequestedHeight>250</RequestedHeight>
      </TabletSettings>
      <PhoneSettings>
        <SourceLocation DefaultValue="https://featuretest.olkeco.com/FeatureTest/Read/readIndexDebug.htm" />
      </PhoneSettings>
    </Form>
    <Form xsi:type="ItemEdit">
      <DesktopSettings>
        <SourceLocation DefaultValue="https://featuretest.olkeco.com/FeatureTest/Compose/composeIndexDebug.htm" />
      </DesktopSettings>
      <TabletSettings>
        <SourceLocation DefaultValue="https://featuretest.olkeco.com/FeatureTest/Compose/composeIndexDebug.htm" />
      </TabletSettings>
      <PhoneSettings>
        <SourceLocation DefaultValue="https://featuretest.olkeco.com/FeatureTest/Compose/composeIndexDebug.htm" />
      </PhoneSettings>
    </Form>
  </FormSettings>
  <Permissions>ReadWriteMailbox</Permissions>
  <Rule xsi:type="RuleCollection" Mode="Or">
    <Rule xsi:type="ItemHasRegularExpressionMatch" RegExName="Regex1" RegExValue="IAmARegexAMA" PropertyName="BodyAsPlaintext" />
    <Rule xsi:type="ItemHasRegularExpressionMatch" RegExName="Regex2" RegExValue="Hello\sWorld" PropertyName="BodyAsPlaintext" />
    <Rule xsi:type="ItemHasKnownEntity"  EntityType="Address" FilterName="microsoft" RegExFilter="microsoft" IgnoreCase="true"/>
    <Rule xsi:type="ItemHasKnownEntity"  EntityType="MeetingSuggestion"/>
    <Rule xsi:type="ItemIs" ItemType="Message" FormType="ReadOrEdit"/>
    <Rule xsi:type="ItemIs" ItemType="Appointment" FormType="ReadOrEdit"/>
  </Rule>
  <VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides" xsi:type="VersionOverridesV1_0">
    <Requirements>
      <bt:Sets DefaultMinVersion="1.3">
        <bt:Set Name="Mailbox" />
      </bt:Sets>
    </Requirements>
    <VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides/1.1" xsi:type="VersionOverridesV1_1">
      <Requirements>
        <bt:Sets DefaultMinVersion="1.3">
          <bt:Set Name="Mailbox" />
        </bt:Sets>
      </Requirements>
      <Hosts>
        <Host xsi:type="MailHost">
          <!-- Runtimes -->
          <Runtimes>
            <Runtime resid="runtime0">
              <Override type="javascript" resid="runtime0Js" />
            </Runtime>
          </Runtimes>
          <!-- DESKTOP -->
          <DesktopFormFactor>
            <SupportsSharedFolders>true</SupportsSharedFolders>
            <FunctionFile resid="functionFile" />
            <!-- Message compose form -->
            <ExtensionPoint xsi:type="MessageComposeCommandSurface">
              <OfficeTab id="TabDefault">
                <Group id="msgComposeDemoGroup">
                  <Label resid="coreLabel" />
                  <!-- Task pane button -->
                  <Control xsi:type="Button" id="msgComposeCoreButton">
                    <Label resid="coreButtonLabel" />
                    <Supertip>
                      <Title resid="paneComposeSuperTipTitle" />
                      <Description resid="paneComposeSuperTipDescription" />
                    </Supertip>
                    <Icon>
                      <bt:Image size="16" resid="dog-icon" />
                      <bt:Image size="32" resid="dog-icon" />
                      <bt:Image size="80" resid="dog-icon" />
                    </Icon>
                    <Action xsi:type="ShowTaskpane">
                      <SourceLocation resid="coreTaskPaneUrl" />
                      <SupportsPinning>true</SupportsPinning>
                    </Action>
                  </Control>
                </Group>
              </OfficeTab>
            </ExtensionPoint>

            <!-- ItemSend Event -->
            <!-- Commented out the webview ItemSend for now to accurately dogfood Soft Block -->
            <!-- <ExtensionPoint xsi:type="Events">
              <Event Type="ItemSend" FunctionExecution="synchronous" FunctionName="validateSendable" />
            </ExtensionPoint> -->


            <ExtensionPoint xsi:type="LaunchEvent">
              <LaunchEvents>
                <LaunchEvent Type="OnNewMessageCompose" FunctionName="addDogfoodSignature" />
                <!--<LaunchEvent Type="OnNewAppointmentOrganizer" FunctionName="runLaunchEventAppointmentTests" />-->
                <LaunchEvent Type="OnMessageSend" FunctionName="delaySend" SendMode="PromptUser"/>
                <LaunchEvent Type="OnAppointmentSend" FunctionName="delaySend" SendMode="PromptUser"/>
              </LaunchEvents>
              <SourceLocation resid="runtime0" />
            </ExtensionPoint>

          </DesktopFormFactor>
        </Host>
      </Hosts>
      <Resources>
        <bt:Images>
          <bt:Image id="dog-icon" DefaultValue="https://outlmoe/timwan/dogfoodaddin/icons/dog2.png"/>


          <bt:Image id="taskpanecommand-icon" DefaultValue="https://featuretest.olkeco.com/FeatureTest/Resources/Icon.png"/>
          <bt:Image id="uiless-80" DefaultValue="https://featuretest.olkeco.com/FeatureTest/DisplayDialogPlayground/app/images/uiless-80.png"/>
          <bt:Image id="taskpanecommand-80" DefaultValue="https://featuretest.olkeco.com/FeatureTest/DisplayDialogPlayground/app/images/taskpanecommand-80.png"/>
          <bt:Image id="tools-icon" DefaultValue="https://featuretest.olkeco.com/featureTest/Resources/tools.png"/>
          <bt:Image id="item-send-icon" DefaultValue="https://featuretest.olkeco.com/featureTest/Resources/item-send.png"/>
          <bt:Image id="icon-16" DefaultValue="https://featuretest.olkeco.com/featureTest/Resources/Icon.png"/>
          <bt:Image id="icon-32" DefaultValue="https://featuretest.olkeco.com/featureTest/Resources/Icon.png"/>
          <bt:Image id="icon-80" DefaultValue="https://featuretest.olkeco.com/featureTest/Resources/Icon.png"/>
          <bt:Image id="icon-48" DefaultValue="https://featuretest.olkeco.com/featureTest/Resources/Icon.png"/>
        </bt:Images>
        <bt:Urls>
          <bt:Url id="coreTaskPaneUrl" DefaultValue="https://outlmoe/timwan/dogfoodaddin/core/index.html"/>          

          <bt:Url id="readTaskPaneUrl" DefaultValue="https://featuretest.olkeco.com/FeatureTest/Read/readIndexDebug.htm"/>
          <bt:Url id="readTaskPaneUrlPublic" DefaultValue="https://featuretest.olkeco.com/FeatureTest/Read/readIndexPublic.htm"/>
          <bt:Url id="readTaskPaneUrlOutlookJs" DefaultValue="https://featuretest.olkeco.com/FeatureTest/Read/readIndexOutlookJs.htm"/>
          <bt:Url id="contextualUrl" DefaultValue="https://featuretest.olkeco.com/FeatureTest/Read/readIndexDebug.htm?contextual=true"/>
          <bt:Url id="composeTaskPaneUrl" DefaultValue="https://featuretest.olkeco.com/FeatureTest/Compose/composeIndexDebug.htm"/>
          <bt:Url id="composeTaskPaneUrlPublic" DefaultValue="https://featuretest.olkeco.com/FeatureTest/Compose/composeIndexPublic.htm"/>
          <bt:Url id="composeTaskPaneUrlOutlookJs" DefaultValue="https://featuretest.olkeco.com/FeatureTest/Compose/composeIndexOutlookJs.htm"/>
          <bt:Url id="functionFile" DefaultValue="https://featuretest.olkeco.com/FeatureTest/DisplayDialogPlayground/app/FunctionFile/Functions.html"/>
          <bt:Url id="displayDialogTaskPaneUrl" DefaultValue="https://featuretest.olkeco.com/FeatureTest/DisplayDialogPlayground/app/common/Home/Home.html"/>
          <bt:Url id="tutorialPlaygroundTaskPaneUrl" DefaultValue="https://featuretest.olkeco.com/FeatureTest/TutorialPlayground/AgaveAPIs.html"></bt:Url>
          <bt:Url id="entityViewerUrlPublic" DefaultValue="https://featuretest.olkeco.com/featureTest/EntityViewer/AppRead/Home/Home.html"></bt:Url>
          <bt:Url id="residFunctionFile" DefaultValue="https://featuretest.olkeco.com/featureTest/Compose/onlineMeeting/uiless.html"/>
          <bt:Url id="runtime0" DefaultValue="https://featuretest.olkeco.com/featureTest/Compose/launchEvent/launchEvent.html"/>
          <bt:Url id="runtime0Js" DefaultValue="https://outlmoe/timwan/dogfoodaddin/core/launchEventWin32.js"/>
          <bt:Url id="itemSendTaskPaneUrl" DefaultValue="https://featuretest.olkeco.com/FeatureTest/ItemSendPlayground/Taskpane.html"/>
          <!-- <bt:Url id="Taskpane.Url" DefaultValue="https://featuretest.olkeco.com/featureTest/Read/mobileEvent/taskpane.html"/> -->
        </bt:Urls>
        <bt:ShortStrings>
          <bt:String id="coreLabel" DefaultValue="Outlook Dogfood"/>
          <bt:String id="coreButtonLabel" DefaultValue="Settings"/>



          <bt:String id="residLabel" DefaultValue="Online Meeting Test"/>
          <bt:String id="groupLabel" DefaultValue="API Test"/>
          <!-- Compose mode -->
          <bt:String id="paneComposeButtonLabel" DefaultValue="Step-1 (Compose) Debug"/>
          <bt:String id="paneComposeSuperTipTitle" DefaultValue="Test Compose Mode APIs with Debug API Files"/>
          <bt:String id="paneComposeButtonLabelPublic" DefaultValue="Step-1 (Compose) Ship"/>
          <bt:String id="paneComposeSuperTipTitlePublic" DefaultValue="Test Compose Mode APIs with Ship API Files"/>
          <bt:String id="paneComposeButtonLabelOutlookJs" DefaultValue="Step-1 (Compose)"/>
          <bt:String id="paneComposeTitleOutlookJs" DefaultValue="Test Compose Mode APIs"/>
          <bt:String id="residLaunchEventTests" DefaultValue="LaunchEvent Tests"/>
          <!-- Read mode -->
          <bt:String id="paneReadButtonLabel" DefaultValue="Step-2 (Read) Debug"/>
          <bt:String id="paneReadSuperTipTitle" DefaultValue="Test Read Mode APIs with Debug API Files"/>
          <bt:String id="paneReadButtonLabelPublic" DefaultValue="Step-2 (Read) Ship"/>
          <bt:String id="paneReadSuperTipTitlePublic" DefaultValue="Test Read Mode APIs with Ship API Files"/>
          <bt:String id="paneReadButtonLabelOutlookJs" DefaultValue="Step-2 (Read)"/>
          <bt:String id="paneReadTitleOutlookJs" DefaultValue="Test Read Mode APIs"/>
          <!-- Outlook.js menu -->
          <bt:String id="outlookJsMenuLabel" DefaultValue="Outlook.js"/>
          <!-- Read Contextual -->
          <bt:String id="contextualCardLabel" DefaultValue="Step-3 Debug"/>
          <!-- Display Dialog Playground -->
          <bt:String id="displayDialogButtonLabel" DefaultValue="Display Dialog Playground"/>
          <bt:String id="displayDialogSuperTipTitle" DefaultValue="Tests Display Dialog"/>
          <bt:String id="displayDialogFuncButtonLabel" DefaultValue="UI-less display dialog"/>
          <bt:String id="displayDialogFuncButtonLabel2" DefaultValue="UI-less non-iframeable dialog"/>
          <bt:String id="displayDialogPaneButtonLabel" DefaultValue="Task pane display dialog"/>
          <!-- Tutorial App Playground -->
          <bt:String id="tutorialPlaygroundButtonLabel" DefaultValue="Tutorial PlayGround"></bt:String>
          <bt:String id="tutorialPlaygroundSuperTipTitle" DefaultValue="Tutorial PlayGround App"></bt:String>
          <!-- Tools -->
          <bt:String id="toolsMenuLabel" DefaultValue="Tools"/>
          <bt:String id="entityViewerButtonLabel" DefaultValue="Entity viewer"/>
          <!-- More menu -->
          <bt:String id="moreMenuLabel" DefaultValue="Item Send/Launch Event"/>
          <bt:String id="itemSendTaskPaneButtonLabel" DefaultValue="Item Send Settings"/>
          <bt:String id="itemSendTaskPaneSuperTipTitle" DefaultValue="Edit Item Send Settings"></bt:String>
          <!-- Event Read -->
          <bt:String id="LogButtonLabel" DefaultValue="Log Event"/>
        </bt:ShortStrings>
        <bt:LongStrings>
          <!-- Compose mode -->
          <bt:String id="paneComposeSuperTipDescription" DefaultValue="Step-1: Open a New Compose Form -> Click on Start Test -> Wait for all tests to complete -> Note any errors -> Now Send the generated email"/>
          <!-- Read mode -->
          <bt:String id="paneReadSuperTipDescription" DefaultValue="Note: Please Run Step-1 first by opening a New Compose Form. Step-2: Open the Email Sent in Step-1 -> Click on Start Test -> Wait for all tests to complete -> Note any errors"/>
          <!-- Outlook.js menu -->
          <bt:String id="outlookJsSuperTipDescription" DefaultValue="Tests for outlook.js"/>
          <!-- Display Dialog Playground -->
          <bt:String id="displayDialogSuperTipDescription" DefaultValue="Tests UI-less, non-iframeable, and task pane DisplayDialog"/>
          <bt:String id="funcComposeSuperTipDescription" DefaultValue="Tests UI-less display dialog."/>
          <bt:String id="funcReadSuperTipDescription" DefaultValue="Tests UI-less non-iframeable dialog"/>
          <bt:String id="paneSuperTipDescription" DefaultValue="Tests task pane display dialog"/>
          <!-- Tutorial App Playground -->
          <bt:String id="tutorialPlaygroundSuperTipDesc" DefaultValue="Starts the Tutorial Playground App"/>
          <!-- Tools -->
          <bt:String id="toolsSuperTipDescription" DefaultValue="Various utilities to aid add-ins development and troubleshooting"/>
          <bt:String id="entityViewerSuperTipDescription" DefaultValue="Examine entity-extraction related properties stamped on the item"/>
          <!-- Others -->
          <bt:String id="residLaunchEventTestsDesc" DefaultValue="Run LaunchEvent tests on this message."/>
          <bt:String id="moreSuperTipDescription" DefaultValue="Run more commands"/>
          <bt:String id="itemSendSuperTipDesc" DefaultValue="Test settings for item send"/>
        </bt:LongStrings>
      </Resources>
      <ConnectedServiceControls>
        <Scopes>
          <Scope>DownloadOnlineContent</Scope>
        </Scopes>
      </ConnectedServiceControls>
	  <ExtendedPermissions>
		<ExtendedPermission>AppendOnSend</ExtendedPermission>
	  </ExtendedPermissions>
    </VersionOverrides>
  </VersionOverrides>
</OfficeApp>
